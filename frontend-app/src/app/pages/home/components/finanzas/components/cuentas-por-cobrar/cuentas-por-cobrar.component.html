<div class="toolbar">
  <ion-searchbar placeholder="Buscar cliente..." (ionInput)="onSearchChange($event)" class="search-bar"></ion-searchbar>
  
  <div class="filter-container">
    <ion-select [value]="filterEstado" (ionChange)="onFilterChange($event)" interface="popover">
      <ion-select-option value="PENDIENTE">Pendientes</ion-select-option>
      <ion-select-option value="VENCIDO">Vencidos</ion-select-option>
      <ion-select-option value="PAGADO">Pagados</ion-select-option>
      <ion-select-option value="TODOS">Todos</ion-select-option>
    </ion-select>
  </div>
</div>

<div class="table-container">
  <table class="data-table">
    <thead>
      <tr>
        <th>Cliente</th>
        <th>Fecha</th>
        <th>Vencimiento</th>
        <th>Monto Total</th>
        <th>Saldo</th>
        <th>Estado</th>
        <th>Acciones</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let deuda of filteredDeudas">
        <td data-label="Cliente">
          <div class="client-info">
            <span class="name">{{ deuda.cliente?.nombre }}</span>
            <span class="cedula">{{ deuda.cliente?.cedula }}</span>
          </div>
        </td>
        <td data-label="Fecha">{{ deuda.fechaCreacion | date:'shortDate' }}</td>
        <td data-label="Vencimiento">{{ deuda.fechaVencimiento ? (deuda.fechaVencimiento | date:'shortDate') : '-' }}</td>
        <td data-label="Monto Total">{{ deuda.montoTotal | currency:'USD' }}</td>
        <td data-label="Saldo" class="amount-pending">{{ deuda.saldoPendiente | currency:'USD' }}</td>
        <td data-label="Estado">
          <ion-badge [color]="deuda.estado === 'PAGADO' ? 'success' : (deuda.estado === 'VENCIDO' ? 'danger' : 'warning')">
            {{ deuda.estado }}
          </ion-badge>
        </td>
        <td data-label="Acciones">
          <ion-button *ngIf="deuda.estado !== 'PAGADO'" size="small" (click)="registrarAbono(deuda)">
            <ion-icon slot="start" name="cash-outline"></ion-icon>
            Abonar
          </ion-button>
        </td>
      </tr>
      <tr *ngIf="filteredDeudas.length === 0">
        <td colspan="7" class="empty-state">
          No se encontraron deudas con los filtros seleccionados.
        </td>
      </tr>
    </tbody>
  </table>
</div>
