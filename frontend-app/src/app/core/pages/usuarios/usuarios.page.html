<ion-split-pane contentId="usuarios-content" when="lg">
  <ion-menu contentId="usuarios-content" type="overlay">
    <ion-content class="sidebar">
      <div class="brand">
        <div class="brand-icon"><ion-icon name="bag-handle-outline"></ion-icon></div>
        <div class="brand-name">SmartPOS</div>
      </div>
      <ion-list>
        <ion-item button (click)="goTo('/home')">
          <ion-icon slot="start" name="home-outline"></ion-icon>
          <ion-label>Dashboard</ion-label>
        </ion-item>
        <ion-item button class="active">
          <ion-icon slot="start" name="people-circle-outline"></ion-icon>
          <ion-label>Usuarios</ion-label>
        </ion-item>
        <ion-item button (click)="goTo('/ventas')">
          <ion-icon slot="start" name="cart-outline"></ion-icon>
          <ion-label>Ventas</ion-label>
        </ion-item>
        <ion-item button (click)="goTo('/configuracion')">
          <ion-icon slot="start" name="settings-outline"></ion-icon>
          <ion-label>Configuración</ion-label>
        </ion-item>
      </ion-list>
    </ion-content>
  </ion-menu>

  <ion-content id="usuarios-content" class="main-content">
    <ion-header class="topbar" collapse="fade">
      <ion-toolbar>
        <ion-buttons slot="start">
          <ion-menu-button></ion-menu-button>
        </ion-buttons>
        <ion-title>Gestión de Usuarios</ion-title>
        <ion-buttons slot="end">
          <ion-button color="primary" (click)="mostrarFormularioCrear()">
            Crear Nuevo Usuario
          </ion-button>
        </ion-buttons>
      </ion-toolbar>
    </ion-header>

    <div class="usuarios-container">
      <!-- Lista de usuarios -->
      <div class="usuarios-grid">
        <!-- Usuario Administrador de ejemplo -->
        <div class="usuario-card">
          <div class="usuario-avatar">
            <ion-icon name="person-circle"></ion-icon>
          </div>
          <div class="usuario-info">
            <h3 class="usuario-nombre">Administrador</h3>
          </div>
          <div class="usuario-status">
            <span class="badge activo">Activo</span>
          </div>
        </div>

        <!-- Usuario Trabajador de ejemplo -->
        <div class="usuario-card">
          <div class="usuario-avatar trabajador">
            <ion-icon name="person-circle"></ion-icon>
          </div>
          <div class="usuario-info">
            <h3 class="usuario-nombre">Trabajador</h3>
          </div>
          <div class="usuario-status">
            <span class="badge activo">Activo</span>
          </div>
        </div>

        <!-- Lista dinámica de usuarios desde la BD -->
        <div *ngFor="let usuario of usuarios" class="usuario-card">
          <div class="usuario-avatar" [class.trabajador]="usuario.rol === 'trabajador'">
            <ion-icon name="person-circle"></ion-icon>
          </div>
          <div class="usuario-info">
            <h3 class="usuario-nombre">{{usuario.nombre || usuario.rol}}</h3>
          </div>
          <div class="usuario-status">
            <span class="badge" [class.activo]="usuario.activo" [class.inactivo]="!usuario.activo">
              {{usuario.activo ? 'Activo' : 'Inactivo'}}
            </span>
          </div>
        </div>
      </div>

      <!-- Estado vacío -->
      <div *ngIf="usuarios.length === 0" class="empty-state">
        <ion-icon name="people-outline"></ion-icon>
        <h3>No hay usuarios adicionales</h3>
        <p>Los usuarios predeterminados se muestran arriba</p>
      </div>
    </div>
  </ion-content>
</ion-split-pane>

<!-- Modal para crear usuario -->
<ion-modal [isOpen]="mostrarFormulario" (didDismiss)="cerrarFormulario()">
  <ng-template>
    <ion-header>
      <ion-toolbar color="primary">
        <ion-title>Crear Nuevo Usuario</ion-title>
        <ion-buttons slot="end">
          <ion-button (click)="cerrarFormulario()">
            <ion-icon name="close" slot="icon-only"></ion-icon>
          </ion-button>
        </ion-buttons>
      </ion-toolbar>
    </ion-header>
    
    <ion-content class="ion-padding">
      <form [formGroup]="formgroup" (ngSubmit)="crearUsuario()">
        <ion-item class="form-item">
          <ion-label position="floating">Nombre</ion-label>
          <ion-input formControlName="nombre" type="text"></ion-input>
        </ion-item>

        <ion-item class="form-item">
          <ion-label position="floating">Correo</ion-label>
          <ion-input formControlName="correo" type="email"></ion-input>
        </ion-item>

        <ion-item class="form-item">
          <ion-label position="floating">Contraseña</ion-label>
          <ion-input formControlName="passwordHash" type="password"></ion-input>
        </ion-item>

        <ion-item class="form-item">
          <ion-label>Rol</ion-label>
          <ion-select formControlName="rol" placeholder="Seleccionar rol">
            <ion-select-option value="administrador">Administrador</ion-select-option>
            <ion-select-option value="trabajador">Trabajador</ion-select-option>
          </ion-select>
        </ion-item>

        <ion-item class="form-item">
          <ion-label>Estado</ion-label>
          <ion-select formControlName="activo" placeholder="Seleccionar estado">
            <ion-select-option [value]="true">Activo</ion-select-option>
            <ion-select-option [value]="false">Inactivo</ion-select-option>
          </ion-select>
        </ion-item>

        <div class="form-actions">
          <ion-button expand="block" type="submit" color="primary" [disabled]="formgroup.invalid">
            <ion-icon slot="start" name="add-circle-outline"></ion-icon>
            Crear Usuario
          </ion-button>
        </div>
      </form>
    </ion-content>
  </ng-template>
</ion-modal>